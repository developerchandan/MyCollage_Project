jQuery(document).ready(function(e){function r(){t.height("auto").height(e("#slider-slides").height())}function i(){e(".slider-slide-tabs").tabs({selected:0,show:function(e,t){r()}})}function s(){$colorpicker_inputs=jQuery("input.popup-colorpicker");$colorpicker_inputs.each(function(){var e=jQuery(this),t="#"+jQuery(this).attr("id")+"picker",n=jQuery.farbtastic(t,function(t){e.css({backgroundColor:t,color:n.hsl[2]>.5?"#000":"#fff"}).val(t);n.bound==1?e.change():n.bound=!0});n.setColor(e.val())});$colorpicker_inputs.each(function(e){jQuery(this).next(".farb-popup").hide()});$colorpicker_inputs.live("focus",function(e){jQuery(this).next(".farb-popup").show();jQuery(this).parents(".farb-popup").css({position:"relative",zIndex:"9999"});jQuery("#slider-slides .slider-slide-tabs .tabs-content").css({overflow:"visible"})});$colorpicker_inputs.live("blur",function(e){jQuery(this).next(".farb-popup").hide();jQuery(this).parents(".farb-popup").css({zIndex:"0"})})}var t=e("#slider-slides"),n=t.children(".slide");r();i();s();var o=e(".slide").last().attr("data-slide");e("#add-slider-slide").click(function(e){t.height("auto");var n=t.children(".slide").last().clone();n.removeClass("closed").children(".inside").show().end().find(".button-type").hide().end().find(".button-type.text").show().end().find("select").val("").end().find("input[type=text]").val("").end().find("textarea").val("").end().find("img.img-preview").attr("src","").end().attr("id","slide_"+ ++o).attr("data-slide",o).find("input.popup-colorpicker").attr("id",o).end().find("div.color-picker").attr("id",o+"picker").end().insertAfter(t.children(".slide").last());i();r();s();e.preventDefault()});t.on("click",".remove-slide",function(n){if(t.children(".slide").length==1)alert("You need to have at least 1 slide!");else{e(this).parents(".slide").remove();r()}n.preventDefault()});t.sortable({handle:"h3.hndle",placeholder:"sortable-placeholder",sort:function(t,n){e(".sortable-placeholder").height(e(this).find(".ui-sortable-helper").height())},tolerance:"pointer"});t.on("click",".hndle",function(){e(this).siblings(".inside").toggle().end().parent().toggleClass("closed");r()});t.on("click",".handlediv",function(){e(this).siblings(".hndle").trigger("click")});t.on("click",".upload-image",function(t){var n=e(this),r=e('input[name="slider-meta-info"]').val().split("|"),i=r[0],s=r[1],o;tb_show("","media-upload.php?post_id="+i+"&field_id="+s+"&type=image&TB_iframe=true&width=670&height=600");o=setInterval(function(){e("#TB_iframeContent").contents().find(".savesend .button").val("Use This Image")},1e3);window.send_to_editor=function(t){clearInterval(o);var r=e("img",t).attr("src");n.siblings('input[type="text"]').val(r);tb_remove();var i=setTimeout(function(){n.siblings(".preview-image").children("img.img-preview").attr("src",n.siblings('input[type="text"]').val())},1500)};t.preventDefault()})});